(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{app:function(e,t,n){"use strict";n.r(t),n.d(t,"App",(function(){return w}));var i,s=n("aurelia-templating-resources"),r=n("aurelia-framework"),a=n("8p7n"),o=n("uShe"),c=n("3Qvj"),l=n("Evr9"),u=n("463H"),h=n("0d46");function f(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function v(e,t,n,i,s,r,a){try{var o=e[r](a),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(i,s)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(i,s){var r=e.apply(t,n);function a(e){v(r,i,s,a,o,"next",e)}function o(e){v(r,i,s,a,o,"throw",e)}a(void 0)}))}}function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var w=Object(r.d)(s.a,o.a,c.a,r.b)(i=function(){function e(e,t,n,i){var s=this;this.viewPane={main:"home",entityPane:"mining",showingItem:null,version:"beta",showSubUp:!1},this.viewHelpers={PlayerBlock:function(e){tfmg.select_FacBlock(tfmg.player,!0),tfmg.viewPane.main="entities",tfmg.viewPane.entityPane=e}},this.showTut=!0,this.dataBase={},this.viewRecCat=!1,this.tooltip=null,window.tfmg=this,this.signaler=e,t.onLoadComplete((function(e){s.init(e,n)})),t.beginLoad(),this.CC=h.a,this.saveGame=t.saveGame,i.expressionObserver(this,"viewPane.main").subscribe((function(e,t){s.whenCheck(e,t,"main")})),i.expressionObserver(this,"viewPane.entityPane").subscribe((function(e,t){s.whenCheck(e,t,"entityPane")}))}var t,n,i,s=e.prototype;return s.init=function(){var e=m(regeneratorRuntime.mark((function e(t,n){var i,s,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mgrs=t.mgrs,this.mgrs.DS=n,this.mgrs.baseApp=this,this.mgrs.signaler=this.signaler,t.save&&t.save.version==u.a)for(this.player=a.b.deserialize(this.mgrs,t.save.player),this.facBlocks=[],this.showTut=!1,i=f(t.save.facBlocks);!(s=i()).done;)r=s.value,this.facBlocks.push(a.a.deserialize(r));else this.facBlocks=[],this.player=new a.b(20),this.mgrs.signaler.signal("generalUpdate");return this.mgrs.rec.set_player(this.player),this.mgrs.rec.sub_ticker(this.mgrs.Ticker),this.select_FacBlock(this.player,!0),e.next=10,this.mgrs.idb.get("dev");case 10:this.showDev=e.sent,this.showDev||(this.showTut&&l.a.start(),!this.showTut&&this.autoSave(),this.mgrs.Ticker.toggle());case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),s.vrcToggle=function(e){this.viewRecCat=this.viewRecCat!=e&&e},s.hideTutorial=function(){l.a.hide()},s.resetDS=function(){this.mgrs.idb.del("last_ds"),location.reload()},s.setDev=function(){this.mgrs.idb.set("dev",!0),this.showDev=!0},s.unsetDev=function(){this.mgrs.idb.set("dev",!1),this.showDev=!1},s.autoSave=function(){var e=this;this.autoSave.sub?(this.mgrs.Ticker.dispose(this.autoSave.sub),this.autoSave.sub=null):this.autoSave.sub=this.mgrs.Ticker.subscribe((function(){e.save()}),u.c)},s.resetSave=function(){this.saveGame()},s.showing=function(e,t){var n=this;this.viewPane.showingItem&&(this.viewPane.showingItem.selectedClass="");var i=this.viewPane.showingItem;this.viewPane.showingItem=null,this.viewPane.showingCat="",e&&i!=e&&window.setTimeout((function(){e.selectedClass="selected",n.viewPane.showingItem=e,n.viewPane.showingCat=t}),0)},s.add_FacBlock=function(e,t){if(!(t=t||prompt("Enter Block Name")))return!1;var n=new a.a(e,t);return this.facBlocks.push(n),n},s.select_FacBlock=function(e,t){void 0===t&&(t=!1),this.showItem=null,this.viewPane.facBlock=e,this.viewPlayer=t},s.when=function(e,t){this.whenTarg={targ:e,cb:t},console.log("whenSet")},s.whenCheck=function(e,t,n){this.whenTarg&&(this.whenTarg.targ.entityPane&&this.viewPane.entityPane!=this.whenTarg.targ.entityPane||this.whenTarg.targ.main&&this.viewPane.main!=this.whenTarg.targ.main||(this.whenTarg.cb(),this.whenTarg=void 0))},s.save=function(){var e=m(regeneratorRuntime.mark((function e(){var t,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={player:{}},console.log("saving..."),t.version=u.a,t.techs=this.mgrs.tech.serialize(),t.player=this.player.serialize(),t.facBlocks=[],n=f(this.facBlocks);!(i=n()).done;)s=i.value,t.facBlocks.push(s.serialize());this.saveGame(t),console.log("...done");case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.jumpStart=function(){this.player.inv.add("burner-mining-drill",2),this.player.inv.add("assembling-machine-1",2),this.player.inv.add("lab",2),this.player.inv.add("automation-science-pack",200)},s.testing=function(){this.player2=new a.b(10),this.add_FacBlock("resource","iron-mine"),this.facBlocks[0].lines[0].AddEntity("burner-mining-drill"),this.facBlocks[0].lines[0].AddEntity("burner-mining-drill"),this.facBlocks[0].lines[0].SetEntityFn(this.mgrs.res.resList["iron-ore"]),this.add_FacBlock("factory","iron-plates"),this.facBlocks[1].lines[0].AddEntity("stone-furnace"),this.facBlocks[1].lines[0].AddEntity("stone-furnace"),this.facBlocks[1].lines[0].SetEntityFn(this.mgrs.rec.recipeList["iron-plate"]),this.add_FacBlock("resource","copper-mine"),this.facBlocks[2].lines[0].AddEntity("burner-mining-drill"),this.facBlocks[2].lines[0].AddEntity("burner-mining-drill"),this.facBlocks[2].lines[0].SetEntityFn(this.mgrs.res.resList["copper-ore"]),this.add_FacBlock("factory","copper-plates"),this.facBlocks[3].lines[0].AddEntity("stone-furnace"),this.facBlocks[3].lines[0].AddEntity("stone-furnace"),this.facBlocks[3].lines[0].SetEntityFn(this.mgrs.rec.recipeList["copper-plate"]),this.add_FacBlock("bus","plates"),this.facBlocks[0].AddBusDrain(this.facBlocks[1]),this.facBlocks[1].AddBusDrain(this.facBlocks[4]),this.facBlocks[2].AddBusDrain(this.facBlocks[3]),this.facBlocks[3].AddBusDrain(this.facBlocks[4]),this.player.inv.add("inserter",10)},t=e,(n=[{key:"showItem",set:function(e){var t=this;this.viewPane.showingItem&&(this.viewPane.showingItem.selectedClass="");var n=this.viewPane.showingItem;this.viewPane.showingItem=null,this.viewPane.showingCat="",e&&n!=e.item&&window.setTimeout((function(){e.item.selectedClass="selected",t.viewPane.showingItem=e.item,t.viewPane.showingCat=e.cat}),0)}}])&&g(t.prototype,n),i&&g(t,i),e}())||i},wb4v:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("+Aae");var i=n("EfK0");function s(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t,n){if((null==n?void 0:n.debug)&&(console.log("debug:"),console.log(e),console.log(t),console.log(n)),0!=(null==n?void 0:n.maxXfer)){var r="entity"==(null==n?void 0:n.toAs)?"recieveItem":"addStack",a=0,o=function(s){(null==n?void 0:n.debug)&&console.log(s);var a=t[r](s);return(null==n?void 0:n.debug)&&console.log(a),a&&e.consumeAll(new i.b(s.name,a)),null==n||n.debug,a},c=(null==n?void 0:n.maxXfer)?function(e){return Math.min(e,n.maxXfer-a)}:function(e){return e};if(null==n?void 0:n.stacks)for(var l,u=s(n.stacks);!(l=u()).done;){o(l.value)}else for(var h,f=s(e.items);!(h=f()).done;){var d=h.value;if(d&&d.name&&0!=d.count&&((!(null==n?void 0:n.types)||n.types.includes(d.name))&&(a+=o({name:d.name,count:c(d.count)}),(null==n?void 0:n.debug)&&console.log("accum: "+a),(null==n?void 0:n.maxXfer)&&n.maxXfer==a)))return}}}n("0d46").a.InvXFer=a,globalThis.InvXFer=a}}]);
//# sourceMappingURL=app~f71cff67.c9dd6f7be9b3ca6c7601.bundle.map