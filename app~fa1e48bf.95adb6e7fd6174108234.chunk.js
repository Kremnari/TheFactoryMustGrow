(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{iVgR:function(e,t,n){"use strict";var a=n("7jDb"),s=n("463H"),r=n("Kh/G"),o=(n("iVpH"),n("uH5N"),n("v3/l"),{Setup:function(e,t){var n=t.getNamedObject("global");!n.activeFeatures.offenseBlocks&&(n.activeFeatures.offenseBlocks={}),n.activeFeatures.offenseBlocks.radar=!0,n.scanning={nextCost:100,currentAccum:0,radarCount:0,landsSurveyed:[],foundTotal:0,enemyDepth:0,enemyDefeated:0,penetrateEnemy:!1,penetrateDepth:!1}}});o.Setup.Igor_Event={name:"Expansion",type:"system_setup"},o.FeatureUpdate=function(e,t){!t.getNamedObject("global").scanning&&t.checkAndEmit("system_setup","Expansion"),t.addEventHandler("tick",o.RadarTick)},o.FeatureUpdate.Igor_Event={name:"Expansion",type:"system_update"},o.AddRadar=function(e,t){if(!t.processTEMP("player.inventory","inventory.consume",{itemStacks:{name:"radar",count:1}}))return t.view.warnToast("No radar in inventory");t.getNamedObject("global").scanning.radarCount++},o.AddRadar.signature={},o.AddRadar.CC_provide="expansion.AddRadar",o.Probabilities=function(e,t,n,a){var s=a.getNamedObject("global").scanning;n.options=[{item:{type:"empty",strength:!1},weight:2},{item:{type:"enemy",strength:100*(s.enemyDefeated+1)},weight:4},{item:{type:"resource",strength:!1},weight:1}],s.foundTotal<10&&(n.options.push({item:{type:"empty",strength:!1},weight:6}),n.options.push({item:{type:"resource",strength:!1},weight:2})),s.enemyDepth>3&&n.options.push({item:{type:"enemy",strength:150*(s.enemyDefeated+1)},weight:4}),s.enemyDefeated>=5&&n.options.push({item:{type:"enemy",class:"hightened",strength:500*(s.enemyDefeated+1)},weight:1}),n.probabilities=n.options.map((function(e,t){return Array(e.weight).fill(t)})).reduce((function(e,t){return e.concat(t)}),[]),t.returnItem&&(n._result=n.options[n.probabilities[Math.floor(Math.random()*n.probabilities.length)]].item)},o.Probabilities.Igor_operation="expansion.landProbabilities",o.RadarTick=function(e,t){if(!(e.ticks%60)){var n=t.getNamedObject("global").scanning;if(0!=n.radarCount&&!(n.enemyDepth>=5)&&!(n.landsSurveyed.length>=10)&&(n.currentAccum+=10*n.radarCount,n.currentAccum>=n.nextCost)){n.foundTotal++,n.currentAccum-=n.nextCost,n.nextCost*=2;var a=t.processTEMP({},"expansion.landProbabilities",{returnItem:!0});"enemy"==a.type&&n.enemyDepth++,5==n.enemyDepth&&(n.penetrateEnemy=!0),n.landsSurveyed.push(a),n.landsSurveyed.length>=10&&(n.penetrateDepth=!0)}}},a.a.defineFeature("Expansion",o);var i={Setup:function(e,t){var n=t.getNamedObject("global");!n.activeFeatures.offenseBlocks&&(n.activeFeatures.offenseBlocks={}),n.activeFeatures.offenseBlocks.offense=!0,!n.offense&&(n.offense={bots:{}})}};i.Setup.Igor_Event={name:"Offense",type:"system_setup"},i.FeatureUpdate=function(e,t){var n=t.getNamedObject("global");n.offense||t.checkAndEmit("system_setup","Offense"),e.addEntity&&(n.offense.bots[e.addEntity]={name:e.addEntity,count:0}),e.addComponent&&(n.offense[addComponent]=0)},i.FeatureUpdate.Igor_Event={name:"Offense",type:"system_update"},i.AddOffenseBot=function(e,t){t.processTEMP("player.inventory","inventory.consume",{itemStacks:{name:e.which.string,count:1}})&&t.getNamedObject("global").offense.bots[e.which.string].count++},i.AddOffenseBot.signature={which:"string"},i.AddOffenseBot.CC_provide="offense.AddOffenseBot",i.Attack=function(e,t){var n=t.getNamedObject("global");if("enemy"==n.scanning.landsSurveyed[0].type){var a=n.offense.target,s=a.strength-10*n.offense.bots.offenseBot.count;a.strength=Math.max(s,0),n.offense.bots.offenseBot.count=Math.abs(Math.min(0,s/10)),n.offense.target.bases=Math.floor(a.strength/100),n.offense.target.units=(a.strength-50*n.offense.target.bases)/10}},i.Attack.signature={},i.Attack.CC_provide="offense.Attack",i.Scout=function(e,t){var n=t.getNamedObject("global"),a=n.scanning.landsSurveyed[0];"enemy"==a.type&&(n.offense.target={},n.offense.target.strength=a.strength,n.offense.target.bases=Math.max(1,Math.floor(a.strength/100)),n.offense.target.units=(a.strength-50*n.offense.target.bases)/10,t.view.signaler.signal("generalUpdate"))},i.Scout.signature={},i.Scout.CC_provide="offense.Scout",i.Secure=function(e,t){var n,a,s=t.getNamedObject("global"),r=s.scanning.landsSurveyed[0];if(null==(n=s.offense)||null==(a=n.target)?void 0:a.strength)return t.view.warnToast("Enemy still has a presence");switch(r.type){case"resource":s.land.res_patches++;break;case"enemy":s.scanning.enemyDepth--,s.scanning.enemyDefeated++,s.scanning.penetrateEnemy=!1,s.offense.target=null}s.land.total+=100,t.view.goodToast("Land secured"),s.scanning.penetrateDepth=!1,s.scanning.landsSurveyed.shift(),t.view.signaler.signal("updateEnemy")},i.Secure.signature={},i.Secure.CC_provide="offense.Secure",a.a.defineFeature("Offense",i);var c={Setup:function(e,t){var n=t.getNamedObject("global");!n.activeFeatures.defenseBlocks&&(n.activeFeatures.defenseBlocks={defense:!0}),!n.defense&&(n.defense={treat:0,turrets:{},attackWaveTimer:0,nextAttackWave:100})}};c.Setup.Igor_Event={name:"Defense",type:"system_setup"},c.FeatureUpdate=function(e,t){var n=t.getNamedObject("global");n.activeFeatures.defenseBlocks||t.checkAndEmit("system_setup","Defense"),e.addEntity&&(n.defense.turrets[e.addEntity]={name:e.addEntity,count:0}),e.addComponent&&(n.defense[addComponent]=0),t.addEventHandler("tick",c.tick)},c.FeatureUpdate.Igor_Event={name:"Defense",type:"system_update"},c.addTurret=function(e,t){t.processTEMP("player.inventory","inventory.consume",{itemStacks:{name:"turret",count:1}})&&t.getNamedObject("global").defense.turrets.turret.count++},c.addTurret.signature={},c.addTurret.CC_provide="defense.AddTurret",c.tick=function(e,t){if(!(e.ticks%30)){var n=t.getNamedObject("global").defense;if(0!=!n.threat)if(++n.attackWaveTimer>=n.nextAttackWave){var a,s;t.view.warnToast("Attack wave"),n.attackWaveTimer=0,n.nextAttackWave=1.2*n.nextAttackWave;var r=null==(a=t.getNamedObject("global").scanning)||null==(s=a.landsSurveyed)?void 0:s[0];"enemy"==(null==r?void 0:r.type)&&(n.nextAttackWave*=.8)}else n.nextAttackSecs=Math.ceil(n.nextAttackWave-n.attackWaveTimer)}},a.a.defineFeature("Defense",c);var d={land:{total:100,used:0,complexity:0,res_patches:2,res_patches_used:0},attackWaves:{nextTimer:100,nextStrength:100,currentTimer:0},player:r.a,activeFeatures:{tutorial:!0},research:{completed:{},progressing:null},unlocked_recipes:[],control:{bonusTicks:0},version:s.a};a.a.defineObj("#",d),a.a.setNamed("player.inventory","player.inv"),a.a.setNamed("research","research"),a.a.setNamed("global",""),a.a.setStatic("config.TICKS_PER_SECOND",s.e),a.a.addEventHandler("gameLoad",(function(e){var t=a.a.getNamed("global");if(t.control){var n=(new Date).getTime()-t.control.lastSave,r=Math.floor(n/1e3*s.e);console.log("added: "+r),t.control.bonusTicks+=Math.floor(r/20)}else t.control={bonusTicks:0}})),a.a.addEventHandler("gameSave",(function(e){a.a.getNamed("global").control.lastSave=(new Date).getTime()})),a.a.provide_CCC("game.fastForward",(function(e,t){var n=t.getNamedObject("global");"true"==e.to.string&&n.control.bonusTicks>0?(n.control.fastForward=!0,t.ticker.fastForward()):(n.control.fastForward=!1,t.ticker.fastForward(!1))}),{to:"string"}),a.a.addEventHandler("tick",(function(e,t){var n=t.getNamedObject("global");n.control.fastForward&&(n.control.bonusTicks--,n.control.bonusTicks<=0&&(n.control.fastForward=!0,t.ticker.fastForward(!1),n.control.bonusTicks=0))}))}}]);
//# sourceMappingURL=app~fa1e48bf.95adb6e7fd6174108234.bundle.map