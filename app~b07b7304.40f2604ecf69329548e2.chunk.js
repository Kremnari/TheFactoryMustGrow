(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"+Aae":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("mUjK"),r=n("EfK0"),a=n("++kE"),o=n("ztCj"),c={icon:new i.a,item:new r.a,rounder:a.a,DS:null,idb:{set:o.f,get:o.d,del:o.c,clear:o.b,list:o.e}}},"Kh/G":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("7jDb"),r={inv:{items:[]},crafting:{list:[],timer:NaN,time:NaN,maxQueue:5,current:0},mining:{list:[],timer:NaN,time:NaN,maxQueue:5,current:0},workshop:{entities:[]}};i.a.provide_CCC("player.inventoryPush",(function(e,t){var n=t.getNamedObject("global").player.workshop.entities,i=t.getNamedObject("global").land;if(t.data.entity[e.which.itemStack.name]&&!["offense","defense"].includes(t.data.entity[e.which.itemStack.name].subType))return i.used+ +t.data.entity[e.which.itemStack.name].space>i.total?t.view.warnToast("Not enough available land"):void(e.which.itemStack.count>0&&t.addNewObject(e.to.entities,"player.entity",{name:e.which.itemStack.name,idx:n.length})&&(e.which.itemStack.count--,t.getNamedObject("global").land.used+=+t.data.entity[e.which.itemStack.name].space,t.view.signaler.signal("entityUpdate"),t.view.signaler.signal("generalUpdate")))}),{which:"itemStack",to:"entities"}),i.a.CCC_addUtility("workshop.moveEntity",(function(e,t,n,i){var r=i.getNamedObject("global").player.workshop.entities,a=i.getId(t.which);t.to=a.order<t.to?Math.min(t.to,r.length-1):Math.max(t.to,0);var o=r.find((function(e){return i.getId(e).order==t.to}));(o=i.getId(o)).order=a.order,a.order=t.to,i.view.signaler.signal("entityUpdate")}));var a=function(e,t){var n=t.getId(e.which.entity);t.processTEMP(n,"entity.clearProcess",{return:e.player.inventory}),t.processTEMP(e.player.inventory,"inventory.add",{itemStacks:[{name:n.name,count:1}]});var i=t.getNamedObject("global").player.workshop.entities,r=i.findIndex((function(t){return t==e.which.entity}));i.splice(r,1);var a=n.order;i.forEach((function(e){var n=t.getId(e);n.order>a&&n.order--})),t.deleteObject(n),t.view.signaler.signal("entityUpdate")};a.signature={which:"entity",player:"inventory"},i.a.provide_CCC("workshop.recover",a,a.signature);var o=function(e,t){var n=e.which.obj.order+e.dir.number;if(n<0||n>e.list.objs.length)return t.view.warnToast("Cannot move");if("string"==typeof e.list.objs[0]){var i=e.list.objs.find((function(e){return t.getId(e).order==n}));t.getId(i).order-=e.dir.number,e.which.obj.order+=e.dir.number}else{e.list.objs.find((function(e){return e.order==n})).order-=e.dir.number,e.which.obj.order+=e.dir.number}t.view.signaler.signal("generalUpdate")};o.signature={which:"obj",list:"objs",dir:"number"},i.a.provide_CCC("object.move",o,o.signature);var c=function(e,t){t.processTEMP(e.which.obj,e.which.obj.$_type+".delete",t)};c.signature={which:"obj",list:"objs"},i.a.provide_CCC("object.delete",c,c.signature);var u=function(e,t,n){var i,r=t.getNamedObject("global").player.crafting;r.current!=r.maxQueue?t.processTEMP("player.inventory","inventory.consume",{itemStacks:e.which.recipe.ingredients})?((null==(i=r.list[r.list.length-1])?void 0:i.name)==e.which.recipe.name?r.list[r.list.length-1].count++:r.list.push({name:e.which.recipe.results[0].name,count:1,recipe:e.which.recipe.name,speed:e.which.recipe.crafting_speed}),0==r.current&&(r.time=NaN),r.current++):t.view.warnToast("Unable to consume ingredients to craft"):t.view.warnToast("Queue Full.  Max: "+r.maxQueue)};u.signature={which:"recipe"},i.a.provide_CCC("player.craft",u,u.signature);var s=function(e,t,n){var i,r=t.getNamedObject("global").player.mining;r.current!=r.maxQueue?((null==(i=r.list[r.list.length-1])?void 0:i.name)==e.which.resource.name?r.list[r.list.length-1].count++:r.list.push({name:e.which.resource.name,count:1,speed:e.which.resource.mining_time}),0==r.current&&(r.time=NaN),r.current++):t.view.warnToast("Queue Full.  Max: "+r.maxQueue)};window.ResourceMine=s,s.signature={which:"resource"},i.a.provide_CCC("resources.mine",s,s.signature);var m=function(e,t){var n=t.getNamedObject("global").player[e.which.queue];if("crafting"==e.which.queue){var i=t.data.recipe[n.list[e.which.idx].recipe];t.processTEMP("player.inventory","inventory.add",{itemStacks:i.ingredients})}n.list[e.which.idx].count>1?n.list[e.which.idx].count--:(n.list.splice(e.which.idx,1),0==e.which.idx&&(n.time=NaN)),n.current--};m.signature={which:["idx","queue"]},i.a.provide_CCC("player.cancelQueue",m,m.signature),i.a.addEventHandler("tick",(function(e,t){var n=t.getNamedObject("global").player,i=n.crafting,r=n.mining;if(i.current>0){if(isNaN(i.time))return i.time=i.list[0].speed*t.getStatic("config.TICKS_PER_SECOND")*2,void(i.timer=0);if(i.timer++,i.timer>=i.time){i.timer=0;var a=t.data.recipe[i.list[0].recipe];t.processTEMP("player.inventory","inventory.add",{itemStacks:a.results}),0==--i.list[0].count&&(i.list.shift(),i.time=NaN),i.current--,0==i.current&&(i.time=NaN)}}if(r.current>0){if(isNaN(r.time))return r.time=r.list[0].speed*t.getStatic("config.TICKS_PER_SECOND")*2,void(r.timer=0);if(r.timer++,r.timer>=r.time){r.timer=0,r.current--;var o=t.data.resource[r.list[0].name];t.processTEMP("player.inventory","inventory.add",{itemStacks:[{name:o.mining_results,count:1}]}),0==--r.list[0].count&&(r.list.shift(),r.time=NaN),0==r.current&&(r.time=NaN)}}}))},main:function(e,t,n){"use strict";n.d(t,"configure",(function(){return r}));n("ls82"),n("SYky");var i=n("BEPO");n("70NS");function r(e){e.use.standardConfiguration().plugin("aurelia-animator-css").plugin("aurelia-dialog").feature("resources/index"),e.use.developmentLogging(i.a?"debug":"warn"),i.b&&e.use.plugin("aurelia-testing"),e.start().then((function(){e.setRoot("app")}))}window.debugIf=function(e,t){e.$$_debug&&e.$$_debug.includes(t)},window.debugCheck=function(e,t){!e.$$_debug&&(e.$$_debug=[]),e.$$_debug.push(t)},Object.walkPath=function(e,t){for(var n=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),i=0,r=n.length;i<r;++i){var a=n[i];"object"==typeof e&&a in e?e=e[a]:Error("Couldn't walk the path completely")}return e}},uH5N:function(e,t,n){"use strict";var i=n("7jDb");function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}
//! I don't think these will work under all circumstances,
function o(e,t,n,i){if(n){for(var r,a=-1,o=4,c=i||0;c<e.length;c++)r=e[c],o>3&&!r&&(o=3,a=c),o>2&&r&&0==r.count&&(o=2,a=c),o>1&&r&&r.name==t&&(o=1,a=c);return 2==o&&(e[a].icon=null),a}var u=e.slice().reverse().findIndex((function(e){return e&&e.name==t&&e.count>0}));return-1==u?-1:e.length-1-u}function c(e,t,n,i){if("string"==typeof e&&e.includes("id")&&(e=i.getId(e).items),e.items&&(e=e.items),t.name){n._result=0;for(var a,o=r(e);!(a=o()).done;){var c=a.value;c&&c.name==t.name&&(n._result+=c.count)}}else if(t.names)for(var u,s=r(e);!(u=s()).done;){var m=u.value;m&&t.names.indexOf(m.name)>-1&&(!n[m.name]&&(n[m.name]=0),n[m.name]+=m.count)}}i.a.addOperation("inventory.add",(function(e,t,n,i){
//! needs to handle a multiplier from args
var a=t.itemStacks;Array.isArray(a)||(a=[a]);for(var c,u=[],s=0,m=r(a);!(c=m()).done;){var l=c.value;if(!l.count&&l.amount&&(l.count=l.amount),0!=l.count){var d=l.count*(t.multi||1);s=e.stackSize||i.data.item[l.name].stack_size,t.force&&(s*=2);for(var h=o(e.items,l.name,s),v=0,p=void 0;!(t.stackLimit&&v>=t.stackLimit)&&h>-1&&d>0;)void 0===e.items[h]?(p=Math.min(s,d),e.items[h]={name:l.name,count:p},d-=p):e.items[h].restricted&&e.items[h].name!=l.name||(d-=p=Math.min(s-e.items[h].count,d),e.items[h].name=l.name,e.items[h].count+=p,0===p&&v++),d&&(h=o(e.items,l.name,s,h+1));-1!=h||e.maxStacks&&!(e.items.length<e.maxStacks)||t.stackLimit&&v>=t.stackLimit||(e.items.push({name:l.name,count:d}),d=0),d>0&&(
//! Theoretically, this would be the case of all existing inventory
//!   is different than the item or full
t.stackLimit?u.push({name:l.name,count:l.count-d}):u.push({name:l.name,count:d}))}}n.part=u,n.complete=0==u.length}
//! This performs multiple loops, could be optimized later
)),i.a.addOperation("inventory.consume",(function(e,t,n,i){var a=t.itemStacks;Array.isArray(a)||(a=[a]);var c=[],u=t.multi||1;if(u>1&&(u=a.reduce((function(t,n){if(-1==t)return-1;var r=i.processTEMP(e,"inventory.total",{name:n.name});return r<n.count?-1:Math.min(t,Math.floor(r/n.count))}),u))<1&&!t.partial)n._result=!1;else{for(var s,m=r(a);!(s=m()).done;){var l=s.value;!l.count&&l.amount&&(l.count=l.amount);for(var d=o(e.items,l.name),h=l.count*u;d>-1&&h;){var v=Math.min(e.items[d].count,h);e.items[d].count-=v,h-=v,d=o(e.items,l.name)}if(c.push({name:l.name,count:l.count*u-h}),h&&!t.partial)
//! we have failed to consume all
return i.processTEMP(e,"inventory.add",{itemStacks:c}),n._result=!1,n}n._result=t.partial&&c||u||!0}})),i.a.addOperation("inventory.total",c),i.a.addOperation("inventory.compress",(function(e,t,n,i){for(var a,o=e.items,c={},u=r(o);!(a=u()).done;){var s=a.value;!c[s.name]&&(c[s.name]=0),c[s.name]+=s.count}o.splice(0,e.items.length);var m=0;for(var l in c)for(;c[l]>0;)m=Math.min(c[l],e.stackSize||i.data.item[l].stack_size),e.items.push({name:l,count:m}),c[l]-=e.items[e.items.length-1].count})),i.a.CCC_addUtility("inventory.total",c)}}]);
//# sourceMappingURL=app~b07b7304.40f2604ecf69329548e2.bundle.map