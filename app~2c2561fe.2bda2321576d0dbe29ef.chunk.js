(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"7jDb":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("rOV7");function n(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(i=t[Symbol.iterator]()).next.bind(i)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}var a={tick_entities:[],object_tickers:{},game:{},objs:[],meta:{},ops:{},metaDefines:{},Tick:function(t){for(var e,i=n(a.tick_entities);!(e=i()).done;){var r=e.value;a.object_tickers[r.as].fn(t,r.obj)}},Tick_Builder:function(t){}},u={get data(){return a.data},finalizeObj:function(t){t.$_id=a.objs.length,a.objs.push(t)}},o={captureEvent:function(t,e){},Ticker_temp:function(t){
//!  Should depreciate ASAP, this is an inversion of control
t.DataProvider((function(t){a.Tick_Builder(t)})),t.subscribe((function(t){a.Tick(t)}))},defineObj:function(t,e,i){a.metaDefines[t]={new:e,actions:i}},addOperation:function(t,e){a.ops[t]={fn:e}},addObjectTickFunction:function(t,e,i){a.object_tickers[e]={object:e,fn:t,tickDataSig:i}},loadDatabase:function(t){a.data=t},loadSave:function(t){a.setGlobal(t)},initialize:function(t){a.ticker=new r.a(t.ticker.ticks_perSec,t.ticker.ticks_maxPhase),o.Ticker=a.ticker,a.graphics=t.viewTasker,a.command=t.commandTasker},getRunner:function(){return f},get:function(t,e){return a.objects_by_name()},setGlobal:function(t){a.game=t},setState:function(t){switch(t){case"start":a.ticker.resume();break;case"stop":a.ticker.pause();break;case"toggle":a.ticker.toggle();break;default:console.warn("IGOR: setting unknown state")}}};Object.defineProperty(o,"globalObject",{get:function(){return a.game}});var f={emit:function(){},get data(){return a.data},processTEMP:function(t,e,i){var r={};return a.ops[e].fn(t,i,r,f,a.ops[e].fn),"_result"in r?r._result:r},addNewObject:function(t,e,i){if(a.metaDefines[e]){var r=a.metaDefines[e].new(i,u);r[0],r[1];return t.push(),!0}return console.warn("cannot find object type"),!1}}},fcJs:function(t,e,i){"use strict";i.d(e,"a",(function(){return g})),i.d(e,"b",(function(){return x}));var r,n=i("By/q"),s=i("zYKg"),a=i("EfK0"),u=i("/tIO"),o=i("+Aae"),f=i("463H"),c=i("wb4v"),h=i("7jDb");function d(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return m(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(i=t[Symbol.iterator]()).next.bind(i)}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function l(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var p=[5,10,20,30,40,50];p.MAX=50;var g=function(){function t(){this.entities_base={},this.entity_cats=[]}var e=t.prototype;return e.import=function(t){var e=this;this.itemMgr=o.a.item,this.techMgr=o.a.tech,Object.entries(t).forEach((function(t){var i=t[0],r=t[1];e.itemMgr.itemList[i]?(e.itemMgr.itemList[i].hasEntity=!0,e.entities_base[i]=r,r.crafting_categories&&r.crafting_categories.forEach((function(t){e.entity_cats[t]||(e.entity_cats[t]=[]),e.entity_cats[t].push(r.name)}))):console.warn("cannot locate  item for entity: "+i)})),Object.defineProperty(this,"avail_cats",{get:function(){var t=this,e=[];return Object.entries(this.entity_cats).forEach((function(i){var r=i[0];i[1].some((function(e){return t.itemMgr.itemList[e].count>0}))&&e.push(r)})),e}}),h.a.Ticker.DataProvider((function(t){e.TickerProvider(t)}))},e.TickerProvider=function(t){t.entities||(t.entities={}),t.entities.types||(t.entities.types=[]),t.entities.types.push("crafting"),t.entities.types.push("mining")},e.EntityType=function(t){return this.entities_base[t].subType},e.GenerateEntity=function(t,e,i){var r=this.entities_base[t];return r.resource_categories?new v(r,e,i):r.crafting_categories?new y(r,e,i):!!r.inputs&&new _(r,e,i)},e.RestoreEntity=function(t,e,i){var r=this.entities_base[t.name],n=null;return"mining"==t.type?(n=new v(r,e,i),""!=t.mining&&n.set_mining(o.a.res.resList[t.mining],t.mining_timer)):"crafting"==t.type?(n=new y(r,e,i),""!=t.recipe&&n.set_recipe(o.a.rec.recipeList[t.recipe],t.crafting_timer)):"lab"==t.type&&((n=new _(r,e,i)).research_timer=t.research_timer),n.restoreBuffers(t.buffers),n},e.upgrade=function(t){var e=t.who.buffers.upgrades[t.dir];if("buffers"==t.type){var i=o.a.baseApp.player.inv.consumeAll([new a.b("iron-chest",1)],!0);i&&!Array.isArray(i)&&(e.size++,t.who.buffers["max_"+t.dir]=p[e.size]||BUFFER_SIZE.MAX)}else if("autoload"==t.type){var r=o.a.baseApp.player.inv.consumeAll([new a.b("inserter",1)],!0);r&&!Array.isArray(r)&&(e.xfer++,e.xferAt||(e.xferAt=0))}},e.craftingCats=function(t){return this.entities_base[t].crafting_categories},t}(),b=function(){function t(t,e,i,r){void 0===r&&(r=null),this.buffers={out:void 0,in:void 0,upgrades:{out:{size:0,xfer:0,xferMod:120,xferProgress:NaN},in:{size:0,xfer:0,xferMod:120,xferProgress:NaN}}},Object.assign(this,t),this.inv=e,this.tags=Object(n.a)({to:i,entity:this}),r&&this.tags.push("type",r),"mining-drill"!=t.type&&Object.defineProperty(this.buffers,"max_in",{get:function(){return this.in.max_stack},set:function(t){this.in.max_stack=t}}),"lab"!=t.type&&Object.defineProperty(this.buffers,"max_out",{get:function(){return this.out.max_stack},set:function(t){this.out.max_stack=t}})}var e=t.prototype;return e.deserialize=function(t){throw new Error("Abstract method, please override")},e.serialize=function(){throw new Error("Abstract method, please override")},e.tick=function(t){console.warn("base entity ticked")},e.restoreBuffers=function(t){t.out&&(this.buffers.out=new a.a(t.out.items,t.out.max_stack)),t.in&&(this.buffers.in=new a.a(t.in.items,t.in.max_stack)),this.buffers.upgrades=t.upgrades,t.max_in&&(this.buffers.max_in=t.max_in),t.max_out&&(this.buffers.max_out=t.max_out)},t}(),v=function(t){function e(e,i,r){var n;return(n=t.call(this,e,i,r,"mining")||this).mining=null,n.buffers.out=new a.a(1),n.buffers.max_out=5,n}l(e,t);var i=e.prototype;return i.deserialize=function(t){Object.assign(this,t)},i.serialize=function(){var t,e={};return e.name=this.name,e.type="mining",e.mining=(null==(t=this.mining)?void 0:t.name)||"",e.buffers={out:this.buffers.out.serialize(),upgrades:this.buffers.upgrades,max_out:this.buffers.max_out},e.mining_timer=this.mining_timer,e},i.tick_outXfer=function(t){++this.buffers.upgrades.out.xferAt>this.buffers.upgrades.out.xferMod&&(Object(c.a)({from:this.buffers.out,to:t.fromParent.drain,options:{maxXfer:this.buffers.upgrades.out.xfer}}),this.buffers.upgrades.out.xferAt=0),this.buffers.upgrades.out.xferProgress=this.buffers.upgrades.out.xferAt/this.buffers.upgrades.out.xferMod*100},i.tick=function(t){this.mining&&this.buffers.out.total(this.mining.mining_results)!=this.buffers.max_out&&(++this.mining_timer>this.mining_time&&(this.buffers.out.add(this.mining.mining_results,1),this.mining_timer=0,o.a.signaler.signal("generalUpdate")),this.progress=this.mining_timer/this.mining_time*100)},i.set_mining=function(t,e){t!=this.mining&&(this.mining&&this.collectBuffer(),this.mining&&this.buffers.out.removeFilter(this.mining.mining_results),t!=this.mining?(this.mining=t,this.mining_time=t.mining_time/this.mining_speed*f.d,this.mining_timer=e||0,this.buffers.out.addFilter(this.mining.mining_results),this.tags.push("ticking","mining"),this.tags.push("outputTicker",!0)):(this.mining=null,this.tags.delete("ticking")))},i.collectBuffer=function(t,e){if(void 0===t&&(t=this),void 0===e&&(e=this.buffers.out.total(this.mining.mining_results)),0!=e){var i=t.inv.add(this.mining.mining_results,e);this.buffers.out.consume(this.mining.mining_results,e-i),o.a.signaler.signal("generalUpdate")}},e}(b),y=function(t){function e(e,i,r){var n;(n=t.call(this,e,i,r,"crafting")||this).recipe=null,n.outputFull=!1;var s="furnace"==n.type?1:5;return n.buffers.in=new a.a(s),n.buffers.max_in=5,n.buffers.out=new a.a(s),n.buffers.max_out=5,n.crafting_timer=NaN,n}l(e,t);var i=e.prototype;return i.tick_outXfer=function(t){++this.buffers.upgrades.out.xferAt>this.buffers.upgrades.out.xferMod&&(Object(c.a)({from:this.buffers.out,to:t.fromParent.drain,options:{maxXfer:this.buffers.upgrades.out.xfer}}),this.buffers.upgrades.out.xferAt=0),this.buffers.upgrades.out.xferProgress=this.buffers.upgrades.out.xferAt/this.buffers.upgrades.out.xferMod*100},i.tick_inXfer=function(t){++this.buffers.upgrades.in.xferAt>this.buffers.upgrades.in.xferMod&&(Object(c.a)({from:t.fromParent.feed,to:this.buffers.in,options:{types:this.recipe.ingredients.map((function(t){return t.name})),maxXfer:this.buffers.upgrades.in.xfer}}),this.outputFull=!1,this.buffers.upgrades.in.xferAt=0),this.buffers.upgrades.in.xferProgress=this.buffers.upgrades.in.xferAt/this.buffers.upgrades.in.xferMod*100},i.tick=function(t){Number.isNaN(this.crafting_timer)?!0===this.buffers.in.consumeAll(this.recipe.ingredients)&&(this.crafting_timer=0):!this.outputFull&&++this.crafting_timer>this.crafting_time&&(this.buffers.out.addAllOrFail(this.recipe.results)?(this.crafting_timer=NaN,this.progress=0,o.a.signaler.signal("generalUpdate")):this.outputFull=!0);this.crafting_timer&&(this.progress=this.crafting_timer/this.crafting_time*100)},i.deserialize=function(t){Object.assign(this,t)},i.serialize=function(){var t,e={};return e.name=this.name,e.type="crafting",e.buffers={out:this.buffers.out.serialize(),in:this.buffers.in.serialize(),upgrades:this.buffers.upgrades,max_out:this.buffers.max_out,max_in:this.buffers.max_in},e.crafting_timer=this.crafting_timer,e.recipe=(null==(t=this.recipe)?void 0:t.name)||"",e},i.dump=function(t,e){t.inv.absorbFrom(this.buffers.out,e.name),this.outputFull=!1},i.clear_recipe=function(){o.a.baseApp.player.inv.absorbFrom(this.buffers.in),o.a.baseApp.player.inv.absorbFrom(this.buffers.out),this.tags.delete("ticking"),this.recipe=null},i.consumeFrom=function(t,e){var i=o.a.rounder.calc(this.buffers.in.total(e.name),this.buffers.max_in,t.total(e.name));t.consume(e.name,i),this.buffers.in.add(e.name,i),this.tags.push("ticking","crafting"),o.a.signaler.signal("generalUpdate")},i.set_recipe=function(t){var e=this;this.recipe&&this.recipe.name!=t.name&&this.clear_recipe(),this.recipe=t,this.crafting_time=t.crafting_speed/this.crafting_speed*f.d,t.ingredients.forEach((function(t,i){e.buffers.in.setFilter(i,t.name)})),t.results.forEach((function(t,i){e.buffers.out.setFilter(i,t.name)})),this.buffers.in.items.length=t.ingredients.length,this.buffers.out.items.length=t.ingredients.length,this.tags.push("ticking","crafting")},e}(b),_=function(t){function e(e,i,r){var n;return(n=t.call(this,e,i,r,"lab")||this).buffers.in=new a.a(n.inputs.length),n.buffers.max_in=5,n.inputs.forEach((function(t,e){return n.buffers.in.setFilter(e,t)})),n.research_timer=NaN,n.tags.push("ticking","lab"),n}l(e,t);var i=e.prototype;return i.deserialize=function(t){Object.assign(this,t)},i.serialize=function(){var t={};return t.name=this.name,t.type="lab",t.buffers={in:this.buffers.in.serialize(),upgrades:this.buffers.upgrades,max_in:this.buffers.max_in},t.research_timer=this.research_timer,t},i.canAdd=function(t){return 0!=this.inv.total(t)&&this.buffers.in.total(t)!=this.buffers.max_in},i.addPotion=function(t){if(this.canAdd(t)){var e=o.a.rounder.calc(this.buffers.in.total(t),this.buffers.max_in,this.inv.total(t));e-=this.inv.consume(t,e),this.buffers.in.add(t,e)}},i.tick_inXfer=function(t){++this.buffers.upgrades.in.xferAt>this.buffers.upgrades.in.xferMod&&(Object(c.a)({from:t.fromParent.feed,to:this.buffers.in,options:{types:this.inputs,maxXfer:this.buffers.upgrades.in.xfer}}),this.outputFull=!1,this.buffers.upgrades.in.xferAt=0),this.buffers.upgrades.in.xferProgress=this.buffers.upgrades.in.xferAt/this.buffers.upgrades.in.xferMod*100},i.tick=function(t){if(o.a.tech.researching){var e=o.a.tech.researching.cost.time*f.d;Number.isNaN(this.research_timer)?this.nextUnit(o.a.tech.nextIngredients):++this.research_timer%e==0&&(o.a.tech.increment_research(),this.research_timer=NaN),this.progress=this.research_timer/e*100||NaN}},i.nextUnit=function(t){var e=this;t&&(t.every((function(t){var i=t[0],r=t[1];return e.buffers.in.total(i)>=r}))&&(t.forEach((function(t){var i=t[0],r=t[1];return e.buffers.in.consume(i,r)})),this.research_timer=0))},e}(b);r=Symbol.iterator;var x=function(){function t(t,e){void 0===e&&(e=!1),this.entities=[],this.entityTags=new s.a,this.parent=t.parent||t,this.restricted=e}var e=t.prototype;return e[r]=function(){return this.entities},t.deserialize=function(e,i){var r,n=new t(e);if(i.restricted&&(n.restricted={},n.restricted.type=i.restricted.type,i.restricted.feed&&u.a.acquire(i.restricted.feed,(function(t){n.restricted.feed=t})),i.restricted.drain&&u.a.acquire(i.restricted.drain,(function(t){n.restricted.drain=t}))),i.setFn){var s,a=i.setFn.split(":"),f=a[0],c=a[1];s="resource"==f?o.a.res.resList[c]:o.a.rec.recipeList[c],n.setFn=s}return i.entities.forEach((function(t){r=o.a.entity.RestoreEntity(t,e.inv,n.entityTags),n.entities.push(r),n.setFn&&n.ApplyEntityFn(r)})),n},e.deserialize=function(t){for(var e,i=null,r=d(t.entities);!(e=r()).done;){var n=e.value;(i=o.a.entity.RestoreEntity(n,this.parent.inv,this.entityTags)).parent=this.parent,this.entities.push(i)}},e.serialize=function(){var t={entities:[]};for(var e in this.restricted&&(t.restricted={type:this.restricted.type},this.restricted.feed&&(t.restricted.feed=this.restricted.feed.name+":"+this.restricted.feed.type),this.restricted.drain&&(t.restricted.drain=this.restricted.drain.name+":"+this.restricted.drain.type)),this.entities)t.entities[e]=this.entities[e].serialize();return this.setFn&&(t.setFn=this.setFn.type+":"+this.setFn.name),t},e.SetEntityFn=function(t){var e=this;if(this.restricted){if(this.setFn){if("crafting"==this.restricted.type){for(var i,r=d(this.setFn.results);!(i=r()).done;){var n=i.value;this.restricted.drain.removeFilter(n.name,!0)}for(var s,a=d(this.setFn.ingredients);!(s=a()).done;){var u=s.value;this.restricted.feed.removeFilter(u.name,!0)}}"mining"==this.restricted.type&&this.restricted.drain.removeFilter(this.setFn.mining_results,!0)}if(this.setFn=t,this.entities.forEach((function(t){return e.ApplyEntityFn(t)})),"crafting"==this.restricted.type){for(var o,f=d(this.setFn.results);!(o=f()).done;){var c=o.value;this.restricted.drain.addFilter(c.name)}for(var h,m=d(this.setFn.ingredients);!(h=m()).done;){var l=h.value;this.restricted.feed.addFilter(l.name)}}"mining"==this.restricted.type&&this.restricted.drain.addFilter(this.setFn.mining_results)}},e.ApplyEntityFn=function(t){this.restricted&&("crafting"!=this.restricted.type?"mining"==this.restricted.type&&t.set_mining(this.setFn):t.set_recipe(this.setFn))},e.AddEntity=function(t){if(this.restricted&&o.a.entity.EntityType(t)!=this.restricted.type)return!1;var e=o.a.entity.GenerateEntity(t,this.parent.inv,this.entityTags);return e.parent=this.parent,this.entities.push(e),this.restricted&&this.setFn&&this.ApplyEntityFn(e),e},e.recieveItem=function(t){for(var e,i,r,n,s=Math.floor(t.count/this.entities.length),a=t.count%this.entities.length,u=0,o=d(this.entities);!(r=o()).done;){var f=r.value;n=void 0,n=s,a>0&&n++&&a--,u+=n,e=n,i=f.buffers.in.add(t.name,e),u-=i}return u},e.tick=function(t){for(var e,i=d(t.entities.types);!(e=i()).done;){var r=e.value;!this.restricted&&this.entityTags.getSetValues("outputTicker",!0).forEach((function(e){return e.tick_outXfer(t)})),this.entityTags.getSetValues("ticking",r).forEach((function(e){return e.tick(t)})),!this.restricted&&this.entityTags.getSetValues("inputTicker",!0).forEach((function(e){return e.tick_inXfer(t)}))}},e.tick_restricted=function(t){t.ticks%30==0&&this.entities.forEach((function(e){Object(c.a)({from:e.buffers.out,to:t.fromParent.drain,options:{maxXfer:1}})}))},t}()},mUjK:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var r=function(){function t(){this.iconList={}}var e=t.prototype;return e.import=function(t){this.iconList=t;for(var e=0,i=Object.entries(this.iconList.tool);e<i.length;e++){var r=i[e],n=r[0],s=r[1];this.iconList.item[n]=s}},e.getSrc=function(t,e){if(!t)return"";if(t.indexOf("@")>-1&&!e){var i=t.split("@");t=i[0],e=i[1]}return this.iconList[t]&&this.iconList[t][e]||this.iconList.item[e]||null},t}()},uShe:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i("+Aae"),n=i("463H");function s(t,e,i,r,n,s,a){try{var u=t[s](a),o=u.value}catch(t){return void i(t)}u.done?e(o):Promise.resolve(o).then(r,n)}function a(t){return function(){var e=this,i=arguments;return new Promise((function(r,n){var a=t.apply(e,i);function u(t){s(a,r,n,u,o,"next",t)}function o(t){s(a,r,n,u,o,"throw",t)}u(void 0)}))}}var u=r.a,o={onLoadComplete:function(t){o.loadCb=t},beginLoad:function(){return a(regeneratorRuntime.mark((function t(){var e,i,r,s,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.idb.get("last_ds");case 2:if(t.t0=t.sent,t.t1=n.b,t.t0==t.t1){t.next=17;break}return console.log("last datasource out of data"),i=location.href.slice(0,location.href.lastIndexOf("/")),t.next=9,fetch(i+"/data_source.json");case 9:return r=t.sent,t.next=12,r.json();case 12:e=t.sent,u.idb.set("last_ds",n.b),u.idb.set("dataSet",e),t.next=21;break;case 17:return console.log("last datasource up to date"),t.next=20,u.idb.get("dataSet");case 20:e=t.sent;case 21:return t.next=23,u.idb.get("Icons");case 23:return(s=t.sent)&&(e.icons=s),t.next=27,u.idb.get("SaveGame");case 27:if(t.t2=t.sent,t.t2){t.next=30;break}t.t2=null;case 30:if(a=t.t2){t.next=39;break}return t.next=34,u.idb.get("SaveGame_Igor");case 34:if(t.t3=t.sent,t.t3){t.next=37;break}t.t3=null;case 37:(a=t.t3)&&!a.version&&(a.version=n.a);case 39:o.init(e,a);case 40:case"end":return t.stop()}}),t)})))()},init:function(t,e){return a(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:u.icon.import(t.icons),u.item.import(t.item),u.res.import(t.resource),u.rec.import(t.recipe,u.item),u.tech.import(t.technology,null==e?void 0:e.techs),u.entity.import(t.entity,u),u.data=t,o.loadCb({mgrs:u,save:e});case 8:case"end":return i.stop()}}),i)})))()},saveGame:function(t){t?u.idb.set("SaveGame",t):(u.idb.del("SaveGame"),window.location.reload())}}}}]);
//# sourceMappingURL=app~2c2561fe.2bda2321576d0dbe29ef.bundle.map