(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"resources/elements/icon-base":function(e,t,i){"use strict";i.r(t),i.d(t,"IconBaseCustomElement",(function(){return v}));var n,s,o,a,r,l,c,u,d,p,h,m,b=i("aurelia-framework"),f=i("+Aae"),g=i("6juG");function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function I(e,t,i,n,s){var o={};return Object.keys(n).forEach((function(e){o[e]=n[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),o),s&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(s):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var E=f.a,v=(s=I((n=function(){function e(){w(this,"item",s,this),w(this,"anim_style",o,this),w(this,"debug",a,this),w(this,"count",r,this),w(this,"altImage",l,this),w(this,"progress",c,this),w(this,"stalled",u,this),w(this,"required",d,this),w(this,"max_fill",p,this),w(this,"metas",h,this),w(this,"showName",m,this),this.parsedCount=null,this.mgrs=E,this.view=g.c}var t=e.prototype;return t.bind=function(e,t){if(this.item){if("string"==typeof this.item)if(this.item.indexOf("@")>-1)this.item={icon:this.item};else{this.altTip=this.item;try{this.item=E.item.get(this.item),this.hasEntity=E.data.entity[this.item.name]}catch(e){console.warn(this.item)}if(!this.item)return}else"object"==typeof this.item&&(this.altTip=this.item.name,this.hasEntity=this.item.hasEntity||E.data.entity[this.item.name]);this.item.icon||(this.item.icon=E.item.get(this.item.name).icon),this.altImage&&-1==this.altImage.indexOf("@")&&(this.altImage="item@"+this.altImage)}},t.itemChanged=function(e){e&&("string"==typeof e?(this.altTip=e,this.item=E.item.get(e)):"object"==typeof e&&(this.altTip=e.name))},t.altImageChanged2=function(e){e&&e.includes("@")&&(console.log("lookup "+e),this.altImage=E.item.get(e),console.log(this.altImage))},e}()).prototype,"item",[b.c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=I(n.prototype,"anim_style",[b.c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=I(n.prototype,"debug",[b.c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=I(n.prototype,"count",[b.c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=I(n.prototype,"altImage",[b.c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=I(n.prototype,"progress",[b.c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=I(n.prototype,"stalled",[b.c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=I(n.prototype,"required",[b.c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=I(n.prototype,"max_fill",[b.c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=I(n.prototype,"metas",[b.c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=I(n.prototype,"showName",[b.c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),n)},"resources/elements/icon-base.html":function(e,t,i){e.exports='<template>\n  <require from="./icon-base.scss"> </require>\n    <div class="${item.filtered && \'ghosted\'}">\n      <img class="main" src.bind="mgrs.icon.getSrc(item.icon)" height="32px"/>\n      <span if.bind="showName" class="nameField">${item.name}</span>\n    </div>\n    <div class="modis"> \n      <span if.bind="altImage" class="altImage"><img src="${mgrs.icon.getSrc(altImage)}" /></span>\n      <span if.bind="max_fill"  class="max_fill" >/${max_fill}</span>\n      <span if.bind="required" class="required">x${required}</span>\n      <span if.bind="count!=undefined">${count}</span>\n    </div>\n    <div class="metas">\n      <span if.bind="metas.showEntity && hasEntity" class="entityIcon">M</span>\n      <span class="${metas.stalled && \'stalled\'} fas fa-circle"></span>\n    </div>\n    <div if.bind="stalled" class="progressBarBase stalled"></div>\n    <div\n      if.bind="!stalled && progress"\n      class="progressBarBase"\n      css="border-image-source: linear-gradient(to right, green ${progress-5}%, red ${progress+10}%)"\n    ></div>\n    <div>\n      <span class="animTarget ${item.animClass2}" style.bind="item.animTime"></span>\n    </div>\n</template>\n'},"resources/elements/icon-base.scss":function(e,t,i){(t=i("JPst")(!1)).push([e.i,"icon-base{display:inline-block;color:#49fb35;font-size:16px;text-align:center;font-weight:700;-webkit-text-stroke:1px #006400;width:40px;height:40px;position:relative;padding:2px;box-sizing:content-box;margin-right:5px}icon-base.half{width:20px;height:20px}icon-base.half img.main{position:absolute;left:2px;top:2px;height:24px}icon-base img.main{position:absolute;left:4px;top:4px}icon-base .metas span.entityIcon{color:red;font-weight:700;bottom:-12px;font-size:1.2em;left:0;right:0;position:absolute;text-align:center}icon-base .metas span.fa-circle{color:transparent;-webkit-text-stroke:#000;transition:all 2s linear;position:absolute;left:0;right:0;bottom:-5px;font-size:.5rem}icon-base .metas span.fa-circle.stalled{color:red;transition:none}icon-base>div{display:inline-block;position:absolute;top:0;left:0;right:0;bottom:0}icon-base span.animTarget{width:32px;height:32px;position:absolute;left:0;top:0}icon-base>.modis>span{position:absolute;font-size:smaller}icon-base>.modis>span.required{color:red;-webkit-text-stroke:#f44}icon-base>.modis>span.max_fill{color:#dc143c}icon-base>.modis>span:first-of-type{bottom:0;right:0}icon-base>.modis>span:nth-of-type(2){bottom:0;left:0}icon-base>.modis>span:nth-of-type(3){top:0;right:0}icon-base>.modis>span:nth-of-type(4){top:0;left:0}icon-base>.modis>span.altImage{height:20px;-webkit-backdrop-filter:blur(1px) hue-rotate(-45deg);backdrop-filter:blur(1px) hue-rotate(-45deg)}.altImage>img{height:100%;position:absolute;right:6px;bottom:6px}.ghosted{border:1px dashed grey;border-radius:4px}.nameField{overflow:auto;white-space:nowrap;position:relative}icon-base.countFull{color:red;-webkit-text-stroke:#f44}",""]),e.exports=t},"resources/elements/iconEditor":function(e,t,i){"use strict";i.r(t),i.d(t,"IconEditor",(function(){return c}));var n,s=i("+Aae"),o=i("aurelia-templating-resources"),a=i("aurelia-framework");function r(e,t,i,n,s,o,a){try{var r=e[o](a),l=r.value}catch(e){return void i(e)}r.done?t(l):Promise.resolve(l).then(n,s)}function l(e){return function(){var t=this,i=arguments;return new Promise((function(n,s){var o=e.apply(t,i);function a(e){r(o,n,s,a,l,"next",e)}function l(e){r(o,n,s,a,l,"throw",e)}a(void 0)}))}}var c=Object(a.d)(o.a)(n=function(){function e(e){this.IE={ds:{old:{},new:{}},select:{},show:"old"},this.show_on=!1,this.mgrs=s.a,this.mgrs.IE=this,this.iconEditor(),this.signaler=e}var t=e.prototype;return t.iconEditor=function(){var e=l(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mgrs.idb.get("Icons");case 2:if(e.t0=e.sent,e.t0){e.next=7;break}return e.next=6,this.mgrs.idb.get("dataSet");case 6:e.t0=e.sent.icons;case 7:return this.IE.ds.new=e.t0,e.next=10,this.mgrs.idb.get("oldIcons");case 10:if(this.IE.ds.old=e.sent,e.t1=this.IE.ds.old,e.t1){e.next=18;break}return e.next=15,this.mgrs.idb.set("oldIcons",this.IE.ds.new);case 15:if(e.t2=e.sent,!e.t2){e.next=18;break}this.IE.ds.old=this.IE.ds.new;case 18:this.signaler.signal("update");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.IEshow=function(){this.IE.showOld=this.IE.ds.old[this.IE.select.Cat][this.IE.select.Icon],this.IE.showNew=this.IE.ds.new[this.IE.select.Cat][this.IE.select.Icon],this.signaler.signal("update")},t.IEfiled=function(){var e=l(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(){var e=l(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new FileReader,e.abrupt("return",new Promise((function(e){i.onload=function(){e(i.result)},i.readAsDataURL(t)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=3,t(this.IE.file[0]);case 3:this.IE.fileBlob=e.sent;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.newIcon=function(){if(!this.newName||-1==this.newName.indexOf("@"))return this.newName=void 0,void console.log("cancel");var e=this.newName.split("@"),t=e[0],i=e[1];this.IE.ds.new[t][i]=null,this.IE.select.Cat=t,this.IE.select.Icon=i,this.show_on=!0,this.signaler.signal("update")},t.deleteNew=function(){this.IE.ds.new[this.IE.select.Cat][this.IE.select.Icon]=null,this.IE.select.Icon=null,this.signaler.signal("update")},t.copyIcon=function(){navigator.clipboard.writeText(this.IE.showNew)},t.IEStore=function(){this.IE.ds.new[this.IE.select.Cat][this.IE.select.Icon]=this.IE.fileBlob,this.IE.fileBlob=null,this.signaler.signal("update")},t.saveIconEditor=function(){var e=l(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mgrs.idb.set("Icons",this.IE.ds.new);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.revertIcon=function(){this.IE.ds.new[this.IE.select.Cat][this.IE.select.Icon]=this.IE.ds.old[this.IE.select.Cat][this.IE.select.Icon]},t.dlIcon=function(e){var t=document.createElement("a");t.download=this.IE.select.Icon+".jpg",t.href="new"==e?this.IE.showNew:this.IE.showOld,t.style="display:none",document.body.appendChild(t),t.click(),t.remove()},t.dlIconEditor=function(){var e=document.createElement("a");e.download="data-icons.json",e.href="data:application/octet-stream:base64,"+JSON.stringify(this.IE.ds.new),e.style="display:none",document.body.appendChild(e),e.click(),e.remove()},t.ulIconEditor=function(){var e=l(regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.IE.upload){e.next=2;break}return e.abrupt("return");case 2:return t=function(){var e=l(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new FileReader,e.abrupt("return",new Promise((function(e){i.onload=function(){e(i.result)},i.readAsText(t)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.t0=JSON,e.next=6,t(this.IE.upload[0]);case 6:e.t1=e.sent,i=e.t0.parse.call(e.t0,e.t1),this.mgrs.idb.set("Icons",i),console.log("loaded");case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}())||n},"resources/elements/iconEditor.html":function(e,t){e.exports='<template>\n  New: <input type="text" placeholder="New Icon cat@name" value.bind="newName"><span click.delegate="newIcon()">Add</span><br>\n\n  New Source?:<input type="checkbox" checked.bind="show_on"></input>\n  <select value.bind="IE.select.Cat">\n    <option repeat.for="cat of IE.ds[show_on ? \'new\': \'old\'] | objectKeys & signal:\'update\'" model.bind="cat">${cat}</option>\n  </select>\n  <select value.bind="IE.select.Icon">\n    <option repeat.for="icon of IE.ds[show_on ? \'new\': \'old\'][IE.select.Cat] | objectKeys & signal:\'update\'" model.bind="icon">${icon}</option>\n  </select>\n  <button click.delegate="IEshow()">Show</button><br>\n  <figcaption class="inline">Old</figcaption>\n  <span class="btn" click.delegate="revertIcon()">Revert</span>\n  <img src.bind="IE.showOld & signal:\'update\'" click.delegate="dlIcon(\'old\')" height="64px" width="64px"/>\n  <img src.bind="IE.showNew & signal:\'update\'" click.delegate="dlIcon(\'new\')" height="64px" width="64px"/>\n  <span class="btn" click.delegate="deleteNew()">Delete</span>\n  <figcaption class="inline">New</figcaption><br>\n  <input type="file" files.bind="IE.file" accept="image/*" change.delegate="IEfiled()">Select replacement</input>\n  <img src.bind="IE.fileBlob & signal:\'update\'"></img><br>\n  <button click.delegate="copyIcon()">Copy</button>\n  <button click.delegate="IEStore()">Store</button>\n  <button click.delegate="saveIconEditor()">SaveDB</button><br>\n  <button click.delegate="dlIconEditor()">Download Json</button>\n  <input type="file" name="name" files.bind="IE.upload" style="display:none" id="IconFileSelect" accept=".json" change.delegate="ulIconEditor()">\n  <button onclick="document.getElementById(\'IconFileSelect\').click();">Upload Json</button>\n</template>\n'},"resources/elements/inventory.html":function(e,t){e.exports='<template>\n  <icon-base\n    repeat.for="item of view.Fn.playerInventory() & signal:\'generalUpdate\'"\n    item.bind="item"\n    if.bind="item.filtered || item.count>0"\n    count.bind="item.count"\n    modis.bind="{count: item.count}"\n    metas.bind="{showEntity: true}"\n    click.delegate="CCC.issue(\'player.inventoryPush\', {\n      \'which.itemStack\': item,\n      \'to.entities\': globals.player.workshop.entities\n    })"\n    mouseenter.trigger="view.set({type: \'scope\', which: \'tooltip\', what: {tool: \'entity\', item: mgrs.data.entity[item.name]}})"\n    mouseleave.trigger="view.unset({which: \'tooltip\'})"\n  ></icon-base>\n</template>\n'}}]);
//# sourceMappingURL=app~8bbcb0b7.a70b91853c1c90d3d226.bundle.map