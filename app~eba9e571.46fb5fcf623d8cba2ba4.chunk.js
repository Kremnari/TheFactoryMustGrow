(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{EfK0:function(t,e,n){"use strict";n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return m}));var i=n("+Aae"),r=(n("wb4v"),n("0d46"),n("7jDb"));function a(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=t[Symbol.iterator]()).next.bind(n)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var c=function(){function t(){this.itemList={}}var e=t.prototype;return e.import=function(t){var e=this;Object.entries(t).forEach((function(t){var n=t[0],i=t[1],r=new o(i);e.itemList[n]=r}))},e.get=function(t){return this.itemList[t]},e.incrementX=function(t){return++this.itemList[t].count},e.addNotifyX=function(t,e){var n;null==(n=this.itemList[t])||n.notifys.push(e)},t}(),o=function(t,e){this.isVisible=!1,this.isCraftable=!1,this.entity=!1,this.notifys=[],this.set_count_callbacks=["ItemNotifys"],Object.assign(this,t)},u=function(){function t(t,e,n){void 0===n&&(n=!1),"string"==typeof t&&(this.name=t),"Object"==typeof t&&(this.name=t.name,this.item=t),this.count=e,this.filtered=n}return t.convert=function(e){return e.count?e:new t(e.name||e.item,e.amount)},t}(),m=function(){function t(t,e){void 0===t&&(t=0),this.items=Array.isArray(t)?t:new Array(t),this.max_stack=e}var e=t.prototype;return e.serialize=function(){return{items:this.items,max_stack:this.max_stack}},t.deserialize=function(e){return new t(e.items,e.max_stack)},e.deserialize=function(t){this.items=t.items,this.max_stack=t.max_stack},e[Symbol.iterator]=function(){return this.items},e.when=function(t,e){var n=this;this.check={itemStack:t,cb:e},this.check.sub=i.a.Ticker.subscribe((function(t){n.whenTickCheck()}))},e.whenTickCheck=function(){if(this.check&&this.total(this.check.itemStack.name)==this.check.itemStack.count){i.a.Ticker.dispose(this.check.sub);var t=this.check.cb;this.check=void 0,t()}},e.addAll=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=1),Array.isArray(t)||(t=[t]);for(var i,r=[],s=0,c=a(t);!(i=c()).done;){var o=i.value;(s=this.add(o.item||o.name,(o.amount||o.count)*n))>0&&r.push(new u(o.name||o.item,s))}if(e)return r},e.addAllOrFail=function(t){for(
//! assume itemStacks is array
var e,n,i=[],r=0,s=!1,c=a(t);!(n=c()).done;){var o=n.value;if(e=u.convert(o),(r=this.add(e.name,e.count))>0){s=!0,e.count-=r,i.push(e);break}i.push(e)}if(s){for(var m,l=a(i);!(m=l()).done;){var h=m.value;this.consume(h.name,h.count)}return!1}return!0},e.consumeAll=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=1),Array.isArray(t)||(t=[t]);for(var i,r=[],s=0,c=a(t);!(i=c()).done;){var o=i.value,m=u.convert(o);if(0===(s=this.consume(m.name,m.count*n)))r.push(m);else if(e)return r.length>=1&&this.addAll(r,!1,n),this.add(m.name,m.count-s),t}return!!e||[]},e.absorbFrom=function(t,e){for(var n,r=a(t.items);!(n=r()).done;){var s=n.value;if(s){var c;e&&s.name!=e||0!=s.count&&(c=this.add(s.name,s.count),t.consume(s.name,s.count-c))}}i.a.signaler.signal("generalUpdate")},e.setFilter=function(t,e,n){if(void 0===n&&(n=i.a.baseApp.player),t>this.items.length)return!1;var r=new u(e,0,!0);if(this.items[t])if(this.items[t].name==e)this.items[t].filtered=!0;else{var a=this.items[t];this.items.splice(t,1,r),n.inv.addAll(a,!1)}else this.items.splice(t,1,r);return!0},e.addFilter=function(t,e){void 0===e&&(e=i.a.baseApp.player);for(var n,r=a(this.items.entries());!(n=r()).done;){var s=n.value,c=s[0],o=s[1];if(!o)return this.items.splice(c,1,new u(t,0,!0)),!0;if(!(o.filtered||o.name!=t&&o.name))return o.filtered=!0,o.name=t,!0}return!1},e.seeFilteredItems=function(){var t=[];return this.items.forEach((function(e){return e.filtered&&t.push(e.name)})),t},e.removeFilter=function(t,e,n){void 0===n&&(n=i.a.baseApp.player);for(var r,s=a(this.items);!(r=s()).done;){var c=r.value;if(c.filtered&&c.name==t)return c.filtered=!1,e&&n.inv.addAll(c),0==c.count&&(c.name=void 0),!0}return!1},e.getTypes=function(t){void 0===t&&(t=!0);for(var e,n=[],i=a(this.items);!(e=i()).done;){var r=e.value;r&&!n.includes(r.name)&&(t||!t&&r.count>0)&&n.push(r.name)}return n},e.total=function(t,e){return void 0===e&&(e=!1),this.items.reduce((function(e,n){return n&&n.name==t?e+n.count:e}),0)},e.addStack=function(t){return 0==t.count?0:t.count-this.add(t.name,t.count)},e.add=function(t,e){if(0!=e){var n=this.max_stack||i.a.item.get(t).stack_size,r=this._GetAddStack(t,n);if(!r)return e;var a=Math.min(n-r.count,e);return r.count+=a,e-a>0?this.add(t,e-a):0}},e.consume=function(t,e){var n=this._GetSubStack(t,!1);return n?n.count>=e?(n.count-=e,0):(e-=n.count,n.count=0,this.consume(t,e)):e},e._GetAddStack=function(t,e){for(var n=-1,i=0,r=[function(n){return n&&n.name==t&&n.count<e},function(t){return t&&0==t.count},function(t){return!t}];i<r.length;i++){var a,s=r[i];if((n=this.items.findIndex(s))>-1&&(!(null==(a=this.items[n])?void 0:a.filtered)||this.items[n].name==t))break}return n>-1&&(!this.items[n]||this.items[n].name!=t)&&this.items.splice(n,1,{name:t,count:0}),this.items[n]},e._GetSubStack=function(t,e){void 0===e&&(e=!0);var n=this.items.length-1-this.items.slice().reverse().findIndex((function(e){return e&&e.name==t&&e.count>0}));return e?n:this.items[n]},e.click=function(t){switch(t.what){case"use":var e=t.which.item||i.a.item.get(t.which.name);if(t.which.count>0&&e.hasEntity)return t.where.useItem(t.which.name)&&t.which.count--,void i.a.signaler.signal("addedEntity");break;case"move":var n=t.rounder.val,r=t.where.inv.consume(t.which.name,n),a=t.who.inv.add(t.which.name,n-r);t.where.inv.add(t.which.name,a)}},t}();//! I don't think these will work under all circumstances,
function l(t,e,n){if(n){for(var i,r=-1,s=4,c=a(t.items.entries());!(i=c()).done;){var o=i.value,u=o[0],m=o[1];s>3&&!m&&(s=3,r=u),s>2&&m&&0==m.count&&(s=2,r=u),s>1&&m&&m.name==e&&m.count<n&&(s=1,r=u)}return 2==s&&(item.name=e),r}var l=t.items.slice().reverse().findIndex((function(t){return t&&t.name==e&&t.count>0}));return-1==l?-1:t.items.length-1-l}r.a.addOperation("inventory.add",(function(t,e,n,i){
//! needs to handle a multiplier from args
var r=e.itemStacks;Array.isArray(r)||(r=[r]);for(var s,c=0,o=a(r);!(s=o()).done;){var u=s.value;if(!u.count&&u.amount&&(u.count=u.amount),0!=u.count){var m=u.count*(e.multi||1);c=i.data.item[u.name].stack_size;for(var h=l(t,u.name,c);h>-1&&m>0;){var f=Math.min(c-t.items[h].count,m);m-=f,t.items[h].count+=f,h=l(t,u.name,c)}m>0&&
//! Theoretically, this would be the case of all existing inventory
//!   is different than the item or full
t.items.push({name:u.name,count:m})}}n.part=[]})),r.a.addOperation("inventory.consume",(function(t,e,n,i){var r=e.itemStacks;Array.isArray(r)||(r=[r]);for(var s,c=[],o=a(r);!(s=o()).done;){var u=s.value;!u.count&&u.amount&&(u.count=u.amount);for(var m=l(t,u.name),h=u.count*(e.multi||1);m>-1&&h;){var f=Math.min(t.items[m].count,h);t.items[m].count-=f,h-=f,m=l(t,u.name)}if(c.push({name:u.name,count:u.count*(e.multi||1)-h}),h)
//! we have failed to consume all
return console.log("readding: "),console.log(c),i.processTEMP(t,"inventory.add",{itemStacks:c}),n._result=!1,n}n._result=!0})),r.a.addOperation("inventory.total",(function(t,e,n,i){if(e.name){n.count=0;for(var r,s=a(t);!(r=s()).done;){var c=r.value;c.name==e.name&&(n.count+=c.count)}}else if(e.names)for(var o,u=a(t);!(o=u()).done;){var m=o.value;e.names.indexOf(m.name)>-1&&(n[m.name]?n[m.name]+=m.count:n[m.name]=m.count)}}))},MJ0g:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("+Aae"),r=n("0d46"),a=n("6juG"),s=function(){function t(){this.recipeList={},this.recipes_by_cats={hand_only:[],crafting:[]},this.showing_item=null,this.crafting={}}var e=t.prototype;return e.import=function(t,e){var n=this;this.itemMgr=e,Object.entries(t).forEach((function(t){var i=t[0],r=t[1],a=new c(r,e,n);a&&(a.ingCheck=function(t){a.ingredients.every((function(e){return t.total(e.name)>=e.amount}),n)?a.classes[o.enabled]="recipeEnabled":a.classes[o.enabled]="recipeDisabled"},a.classes[o.enabled]="recipeDisabled",n.recipeList[i]=a,a.category?(n.recipes_by_cats[a.category]||(n.recipes_by_cats[a.category]=[],n.crafting[a.category]=null),n.recipes_by_cats[a.category].push(a)):n.recipes_by_cats.hand_only.push(a),n.recipes_by_cats.crafting.push(a))}))},e.set_player=function(t){this.player=t},e.sub_ticker=function(t){var e=this;this.TickSub=t.subscribe((function(t){e.tick(t)}))},e.tick=function(){for(var t=0,e=Object.values(this.recipeList);t<e.length;t++){e[t].ingCheck(this.player.inv)}},e.canProduce=function(t,e){return t.ingredients.every((function(t){return e.total(t.name)>=t.amount||!1}))},e.canProduceMax=function(t,e){return t.ingredients.reduce((function(t,n){return Math.min(t,function(t){return Math.floor(e.total(t.name)/t.amount)}(n))}),1/0)},e.consumeIngs=function(t,e,n,i){void 0===n&&(n=1),void 0===i&&(i=!1),t.ingredients.forEach((function(t){i?e.add(t.name,t.amount*n):e.consume(t.name,t.amount*n)}))},e.startCraft=function(t,e,n){var i=this,r=this.crafting[n];if(null!=r&&(window.clearTimeout(r.timer),r.recipe.style="",r.recipe.classes[o.crafting]="",this.consumeIngs(r.recipe,e,1,!0),t.name==r.recipe.name))return this.crafting[n]=null,!1;if(this.canProduce(t,e)){r={},this.consumeIngs(t,e);var a=t.crafting_speed||t.crafting_time;r.timer=window.setTimeout((function(){i.crafting[n]=null,t.animTime=null,t.animClass=null,t.classes[o.crafting]="",i.craft(t,e)}),1e3*a),r.recipe=t,this.crafting[n]=r,t.animTime="animation-duration: "+a+"s",t.animClass="isCrafting",t.classes[o.crafting]="crafting"}},e.craft=function(t,e){t.results.forEach((function(t){e.add(t.name,t.amount||1)}))},e.recipesByTags=function(t,e,n){if(void 0===n&&(n=this.recipeList),null==e)return[];Array.isArray(e)||(e=[e]);var i=!1;return e.includes("crafting")&&(i=!0),Object.values(n).filter((function(n){return(null==n.enabled||n.enabled)&&(e.includes(n[t])||i&&!n[t])}))},t}(),c=function(){function t(t){var e,n=this;if(this.style="",this.classes=[],Object.assign(this,t),this.enabled=null==t.enabled||t.enabled,Object.defineProperty(this,"classesStr",{get:function(){return n.classes.join(" ")}}),""==this.icon&&(this.icon=null==(e=i.a.item.itemList[this.results[0].name])?void 0:e.icon),""==this.icon)return!1}return t.prototype.getClassesX=function(){return console.log("computed"),this.classes.join(" ")},t}(),o={enabled:0,crafting:1};r.b.provide("player.craft",(function(t,e,n){n.rec?(window.clearTimeout(n.timeout),e.processTEMP(t.player.inventory,"inventory.add",{itemStacks:n.rec.ingredients}),a.c.animsUpdate(n.rec,null,null),n.rec=void 0):e.processTEMP(t.player.inventory,"inventory.consume",{itemStacks:t.which.recipe.ingredients})?(n.rec=t.which.recipe,n.timeout=window.setTimeout((function(){e.processTEMP(t.player.inventory,"inventory.add",{itemStacks:n.rec.results}),a.c.animsUpdate(n.rec,null,null),n.rec=void 0}),1e3*t.which.recipe.crafting_speed),n.rec=t.which.recipe,a.c.animsUpdate(n.rec,"isCrafting",t.which.recipe.crafting_speed)):console.log("cannot craft")}),{which:"recipe",player:"inventory"})},O9YP:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i,r=n("EfK0"),a=n("aurelia-framework"),s=n("0d46"),c=n("6juG"),o=Object(a.d)(r.c)(i=function(){function t(t){this.resList={},this.mining=!1,this.ItemMgr=t}var e=t.prototype;return e.import=function(t){var e=this;Object.entries(t).forEach((function(t){var n=t[0],i=t[1];e.resList[n]=i}))},e.mine=function(t,e){var n=this,i=this.resList[t];this.mining?(window.clearTimeout(this.mining),this.mining=!1,i.miningStyle=""):(this.mining=window.setTimeout((function(){e.add(i.mining_results,1),n.mining=!1,i.miningStyle=""}),1e3*i.mining_time),i.miningStyle="animation: testXform "+i.mining_time+"s")},e.resListByTag=function(t,e){return null==e?[]:Object.values(this.resList).filter((function(n){return null==n[t]||e.includes(n[t])}))},t}())||i,u=function(t,e,n){n.res?(window.clearTimeout(n.timeout),c.c.animsUpdate(n,res,null,null),n.res=void 0):(n.timeout=window.setTimeout((function(){e.processTEMP(t.player.inventory,"inventory.add",{itemStacks:[{name:t.which.resource.mining_results,count:1}]}),c.c.animsUpdate(n.res,null,null),n.res=void 0}),1e3*t.which.resource.mining_time),n.res=t.which.resource,c.c.animsUpdate(t.which.resource,"isMining",t.which.resource.mining_time))};window.ResourceMine=u;s.b.provide("resources.mine",u,{which:"resource",player:"inventory"})}}]);
//# sourceMappingURL=app~eba9e571.46fb5fcf623d8cba2ba4.bundle.map