<template>
  <scope-var var.bind="$scope={busLine: viewPane.showingItem}"></scope-var>
  <section click.capture="CCC.provide($event, 'at', 'factoryBus', viewPane.showingItem)" class="container">
    <div class="row">
      <div class="col-sm">
        Space: ${$scope.busLine.size}
      </div>
      <div class="col-sm">
        <h4>${$scope.busLine.name}</h4>
      </div>
      <div class="col-sm">
        Complexity: ${$scope.busLine.complexity}
      </div>
    </div>
    <div class="row">
      <div class="col-sm">
        Max Sources: ${$scope.busLine.connections.maxSources}
        <span
          click.delegate="CCC.issue('factoryBus.expandBus', {'dir.string':'source'}, $event)"
        >Add Access Point</span>
        <ul>
          <li repeat.for="source of $scope.busLine.connections.sources">
            ${source.named}
            <icon-base
              repeat.for="item of IgorJs.getObjId(source.buffer).items"
              item.bind="item.name"
              count.bind="item.count"
            ></icon-base>
            <span if.bind="$scope.busLine.processors.source.xferTarget==$index">&lt;--</span>
          </li>
        </ul>
      </div>
      <div class="col-sm">
        <h5>Central Buffer</h5>
        <div class="row">
          <div>
            <span
              class="progressBarBase"
              css="border-image-source: linear-gradient(to right, green 0%, green ${$scope.busLine.processors.source.xferTimer/$scope.busLine.processors.source.xferTicks*100-10}%, red ${$scope.busLine.processors.source.xferTimer/$scope.busLine.processors.source.xferTicks*100+10}%, red )"
            >Acquisition</span>
            <!--${$scope.busLine.processors.source.xferTimer}-->
          </div>
          <div
            click.delegate="CCC.issue('factoryBus.expandProcessing', {'dir.string':'source'}, $event)"
          >Expand Processing</div>
          <div>
            XferQty: ${$scope.busLine.processors.source.xferQty}
          </div>
        </div>
        <div class="row">
          <div>On the belt</div>
          <icon-base
            repeat.for="item of IgorJs.getObjId($scope.busLine.processors.central).items"
            item.bind="item.name"
            if.bind="item.count>0"
            count.bind="item.count"
          ></icon-base>
        </div>
        <div class="row">
          <div>
            <span
            class="progressBarBase"
            css="border-image-source: linear-gradient(to right, green 0%, green ${$scope.busLine.processors.drain.xferTimer/$scope.busLine.processors.drain.xferTicks*100-10}%, red ${$scope.busLine.processors.drain.xferTimer/$scope.busLine.processors.drain.xferTicks*100+10}%, red )"
            >Deposition</span>
            <!--${$scope.busLine.processors.drain.xferTimer}-->
          </div>
          <div
            click.delegate="CCC.issue('factoryBus.expandProcessing', {'dir.string':'drain'}, $event)"
          >Expand Processing</div>
          <div>
            XferQty: ${$scope.busLine.processors.drain.xferQty}
          </div>
        </div>
      </div>
      <div class="col-sm">
        Max Drains: ${$scope.busLine.connections.maxDrains}
        <span
          click.delegate="CCC.issue('factoryBus.expandBus', {'dir.string':'drain'}, $event)"
        >Add Access Point</span>
        <ul>
          <li repeat.for="drain of $scope.busLine.connections.drains">
            <span if.bind="$scope.busLine.processors.drain.xferTarget==$index">&gt;--</span>
            <icon-base
              repeat.for="item of IgorJs.getObjId(drain.buffer).items"
              item.bind="item.name"
              count.bind="item.count"
            ></icon-base>
            ${drain.named}
          </li>
        </ul>
      </div>
    </div>
  </section>
</template>
