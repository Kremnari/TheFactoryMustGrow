(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"+Aae":function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n("mUjK"),r=n("EfK0"),s=n("O9YP"),u=n("MJ0g"),a=n("59E+"),o=n("rOV7"),c=n("++kE"),p=n("fcJs"),d=n("ztCj"),f={icon:new i.a,item:new r.c,res:new s.a,tech:new a.a,rec:new u.a,entity:new p.a,rounder:c.a,DS:null,idb:{set:d.c,get:d.b,del:d.a},Ticker:new o.a}},"8p7n":function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return v}));var i=n("fcJs"),r=n("EfK0"),s=n("+Aae"),u=n("wb4v");function a(t,e,n,i,r,s,u){try{var a=t[s](u),o=a.value}catch(t){return void n(t)}a.done?e(o):Promise.resolve(o).then(i,r)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var s=t.apply(e,n);function u(t){a(s,i,r,u,o,"next",t)}function o(t){a(s,i,r,u,o,"throw",t)}u(void 0)}))}}function c(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=t[Symbol.iterator]()).next.bind(n)}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function d(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var f=0;function h(t){return"__private_"+f+++"_"+t}var l=function(){function t(e,n){var u,a=this;switch(this.entityTypes=!1,this.upgrades={},e){case"resource":u={output:!0,line:!0},this.entityTypes="mining";break;case"bus":u={input:!0,output:!0,delay:!0},this.tick=this.tick_bus;break;case"research":u={input:!0,line:!0},this.entityTypes="research";break;case"factory":default:this.entityTypes="crafting",u={input:!0,output:!0,line:!0}}this.lines=[],this.feeds=[],this.drains=[],this.name=n,this.type=e,this.upgrades={base:this},t.assign(this.name+":"+this.type,this),u.input&&(this.upgrades.input={buffers:{count:0,type:"buffers",max:3},loaders:{count:0,type:"loaders",max:10}},this.inputLine=new r.a(5,5)),u.output&&(this.upgrades.output={buffers:{count:0,type:"buffers",max:3},loaders:{count:0,type:"loaders",max:10}},this.outputLine=new r.a(5,5)),u.line&&this.lines.push(new i.b(this,{type:this.entityTypes,feed:this.inputLine,drain:this.outputLine})),s.a.Ticker.subscribe((function(t){return a.tick(t)}))}t.assign=function(t,e){d(this,b)[b][t]&&d(this,b)[b][t].forEach((function(t){t(e)})),d(this,y)[y][t]=e},t.acquire=function(t,e){d(this,y)[y][t]?e(d(this,y)[y][t]):(d(this,b)[b][t]||(d(this,b)[b][t]=[]),d(this,b)[b][t].push(e))},t.deserialize=function(e){var n=this,s=new t(e.type,e.name);return s.upgrades=e.upgrades,s.base=s,e.inputLine&&(s.inputLine=r.a.deserialize(e.inputLine)),e.outputLine&&(s.outputLine=r.a.deserialize(e.outputLine)),e.lines&&(s.lines=[],e.lines.forEach((function(t,e){s.lines[e]=i.b.deserialize(n,t)}))),e.feeds&&(s.feeds=[],e.feeds.forEach((function(e,n){return t.acquire(e,(function(t){s.feeds[n]=t}))}))),e.drains&&(s.drains=[],e.drains.forEach((function(e,n){return t.acquire(e,(function(t){s.drains[n]=t}))}))),s};var e=t.prototype;return e.serialize=function(){var t={};return t.name=this.name,t.type=this.type,t.entityTypes=this.entityTypes,this.inputLine&&(t.inputLine=this.inputLine.serialize()),this.outputLine&&(t.outputLine=this.outputLine.serialize()),this.feeds&&(t.feeds=this.feeds.map((function(t){return t.name+":"+t.type}))),this.drains&&(t.drains=this.drains.map((function(t){return t.name+":"+t.type}))),this.lines&&(t.lines=this.lines.map((function(t){return t.serialize()}))),t.upgrades=this.upgrades,t.upgrades.base=void 0,t},e.tick_bus=function(t){if(t.ticks%40==0){for(var e,n=c(this.drains);!(e=n()).done;){var i=e.value;if("bus"==i.type)return;0!=this.upgrades.output.count&&Object(u.a)(this.outputLine,i.inputLine,{maxXfer:this.upgrades.output.loaders.count})}Object(u.a)(this.inputLine,this.outputLine,{maxXfer:2*this.upgrades.input.loaders.count})}},e.tick=function(t){this.inputLine&&t.ticks%30==0&&this.upgrades.input.loaders.count&&Object(u.a)(this.inputLine,this.lines[0],{maxXfer:2*this.upgrades.input.loaders.count,toAs:"entity"}),t.fromParent={feed:this.inputLine,drain:this.outputLine};for(var e,n=c(this.lines);!(e=n()).done;){var i=e.value;i.tick(t),i.tick_restricted(t)}this.drains[0]&&t.ticks%30==0&&this.upgrades.output.loaders.count&&Object(u.a)(this.outputLine,this.drains[0].inputLine,{maxXfer:2*this.upgrades.output.loaders.count})},e.useItem=function(t){if("bus"!=this.type)return this.lines[0].AddEntity(t)},e.add_EntityLine=function(){this.lines.splice(-1,0,new r.a(5),new i.b(this,this.entityTypes))},e.SelectBusFeed=function(){var t=o(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.DS.open("SelectBus",{base:s.a.baseApp});case 2:if(null==(e=t.sent)?void 0:e.selected){t.next=5;break}return t.abrupt("return");case 5:this.AddBusFeed(e.selected);case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.AddBusFeed=function(t){this.inputLine&&t&&!this.feeds.includes(t)&&(this.feeds.push(t),t.AddBusDrain(this))},e.DelBusFeed=function(t){this.feeds=this.feeds.filter((function(e){return e!=t}))},e.SelectBusDrain=function(){var t=o(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.DS.open("SelectBus",{base:s.a.baseApp});case 2:if(null==(e=t.sent)?void 0:e.selected){t.next=5;break}return t.abrupt("return");case 5:this.AddBusDrain(e.selected);case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.AddBusDrain=function(t){t&&!this.drains.includes(t)&&(this.drains.push(t),t.AddBusFeed(this))},e.DelBusDrain=function(t){this.drains=this.drains.filter((function(e){return e!=t}))},e.ApplyUpgrade=function(t){"buffers"!=t.upgrade.type?"loaders"!=t.upgrade.type||0==t.inv.consume("inserter",1)&&t.upgrade.count++:0==t.inv.consume("iron-chest",1)&&(t.upgrade.count++,t.line.max_stack*=2)},t}(),y=h("blocks"),b=h("awaiting");Object.defineProperty(l,y,{writable:!0,value:{}}),Object.defineProperty(l,b,{writable:!0,value:{}});var v=function(){function t(t){var e=this;this.inv=new r.a(t),this.entityStore=new i.b(this),s.a.Ticker.subscribe((function(t){e.tick(t)}))}t.deserialize=function(e,n){var i=new t;return i.inv.deserialize(n.inv),i.entityStore.deserialize(n.entityStore),i};var e=t.prototype;return e.serialize=function(){var t={};return t.inv=this.inv.serialize(),t.entityStore=this.entityStore.serialize(),t},e.getEntities=function(t){var e,n;return t?Array.from((null==(e=this.entityStore.entityTags.get("type"))||null==(n=e.get(t))?void 0:n.values())||[]):Array.from(this.entityStore.entities)},e.useItem=function(t){return this.entityStore.AddEntity(t)},e.tick=function(t){t.fromParent={feed:this.inv,drain:this.inv},this.entityStore.tick(t)},t}()},main:function(t,e,n){"use strict";n.d(e,"configure",(function(){return r}));n("ls82"),n("SYky");var i=n("BEPO");n("70NS");function r(t){t.use.standardConfiguration().plugin("aurelia-animator-css").plugin("aurelia-dialog").feature("resources/index"),t.use.developmentLogging(i.a?"debug":"warn"),i.b&&t.use.plugin("aurelia-testing"),t.start().then((function(){return t.setRoot("app")}))}}}]);
//# sourceMappingURL=app~5a11b65b.fea888db20f68e6ae4ee.bundle.map